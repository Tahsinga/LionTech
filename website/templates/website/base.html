{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>{% block title %}Your Orders - LionTech{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Bootstrap & Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
  
  <!-- Google Font: Inter -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f2f3f5;
      color: #333;
    }

    .header-wrapper {
      background-color: #fff;
      border-bottom: 1px solid #ddd;
      position: sticky;
      top: 0;
      z-index: 1000;
    }

    .navbar-brand span {
      font-size: 24px;
      font-weight: bold;
      color: #01f0fa;
    }

    .order-card {
      background-color: #fff;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
    }

    .order-card h6 {
      font-size: 14px;
      color: #666;
    }

    .order-info {
      font-size: 14px;
      color: #444;
    }

    .order-image {
      width: 100px;
      height: 100px;
      object-fit: contain;
    }

    .order-actions .btn {
      font-size: 13px;
      margin-right: 5px;
      margin-bottom: 5px;
    }

    footer {
      background-color: #fff;
      padding: 15px 0;
      font-size: 13px;
      color: #888;
      text-align: center;
      border-top: 1px solid #ddd;
    }
  </style>
</head>
<body>

<!-- Top Navigation -->
<div class="header-wrapper">
  <nav class="navbar navbar-expand-lg px-3">
    <div class="container-fluid">
      <a class="navbar-brand d-flex align-items-center gap-2" href="{% url 'home' %}">
        <img src="{% static 'website/images/lionetech_logo.png' %}" alt="Logo" style="width:40px; height:40px; border-radius: 50%; object-fit:cover;">
        <span>LIONTECH</span>
      </a>
      <div class="d-flex gap-3">
        <a href="{% url 'account_login' %}" class="nav-link"><i class="bi bi-person-circle me-1"></i>Log In</a>
        <a href="#" class="nav-link position-relative" id="header-open-cart">
          <i class="bi bi-bag"></i>
          <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" id="cart-count">0</span>
        </a>
        <script>
          // Open the cart section when header cart icon is clicked
          document.addEventListener('DOMContentLoaded', function () {
            var el = document.getElementById('header-open-cart');
            if (el) el.addEventListener('click', function (e) {
              e.preventDefault();
              try { if (window.openSection) window.openSection('products_addto_cart'); } catch (err) { window.location.href = '/'; }
            });
          });
        </script>
      </div>
    </div>
  </nav>
</div>

  <!-- Sign-in motivation modal (shows for anonymous visitors, non-annoying) -->
  <div class="modal fade" id="signinPromptModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content border-0 shadow-lg rounded-4 overflow-hidden">
        <div class="modal-body p-4 text-center">
          <div class="mb-3">
            <img src="{% static 'website/images/lionetech_logo.png' %}" alt="LionTech" style="width:64px;height:64px;border-radius:12px;object-fit:cover;">
          </div>
          <h5 class="fw-bold mb-2">Welcome to LionTech</h5>
          <p class="text-muted mb-3">Sign in for a faster checkout, order tracking, and exclusive offers.</p>

          <div class="d-flex gap-2 justify-content-center mb-3">
            <a href="{% url 'account_register' %}" class="btn btn-outline-primary rounded-pill px-4">Create account</a>
            <a href="{% url 'account_login' %}" class="btn btn-primary rounded-pill px-4" style="background: linear-gradient(90deg,#9150EC,#5B2DD1); border: none;">Sign in</a>
          </div>

          <div class="small text-muted">Or continue browsing â€” we won't ask again for a while.</div>
        </div>
        <div class="modal-footer d-flex justify-content-between p-2">
          <button type="button" class="btn btn-sm btn-link text-muted" id="dontShowBtn">Don't show again</button>
          <button type="button" class="btn btn-sm btn-outline-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

<!-- Main Content -->
<main class="container py-4">
  {% block content %}

  <!-- Example Order Card -->
  <div class="order-card">
    <div class="row">
      <div class="col-md-2 text-center">
        <img src="{% static 'website/images/watch.png' %}" class="order-image" alt="Product">
      </div>
      <div class="col-md-7">
        <h6>Delivered 30 July</h6>
        <p class="order-info">
          CMF by Nothing Watch Pro 2, 1.52" AMOLED Display, GPS, Bluetooth calling with AI noise reduction.
        </p>
        <small>Order placed: 29 July 2025 | AED 215.55 | Shipped to: Simbarashe Downey</small>
      </div>
      <div class="col-md-3 text-end order-actions">
        <button class="btn btn-outline-secondary btn-sm">Track package</button>
        <button class="btn btn-outline-secondary btn-sm">Return</button>
        <button class="btn btn-outline-secondary btn-sm">Share receipt</button>
        <button class="btn btn-outline-secondary btn-sm">Write review</button>
      </div>
    </div>
  </div>

  <!-- Another Order -->
  <div class="order-card">
    <div class="row">
      <div class="col-md-2 text-center">
        <img src="{% static 'website/images/headphones.png' %}" class="order-image" alt="Product">
      </div>
      <div class="col-md-7">
        <h6>Delivered 30 July</h6>
        <p class="order-info">
          Sony MDR-ZX110AP Wired On-Ear Headphones, mic for phone calls, tangle-free cable.
        </p>
        <small>Order placed: 29 July 2025 | AED 91.00 | Shipped to: Simbarashe Downey</small>
      </div>
      <div class="col-md-3 text-end order-actions">
        <button class="btn btn-outline-secondary btn-sm">Track package</button>
        <button class="btn btn-outline-secondary btn-sm">Return</button>
        <button class="btn btn-outline-secondary btn-sm">Share receipt</button>
        <button class="btn btn-outline-secondary btn-sm">Write review</button>
      </div>
    </div>
  </div>

  {% endblock %}
</main>

<!-- Footer -->
<footer>
  &copy; 2025 LionTech Zimbabwe. All rights reserved.
</footer>

<!-- Bootstrap Bundle -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
  (function(){
    // Rendered as 'True' or 'False' by Django; compare as string to avoid JS syntax issues
    var isAuthenticated = "{{ request.user.is_authenticated }}" === "True";
    if (isAuthenticated) return; // don't prompt signed-in users

    try {
      var dismissed = localStorage.getItem('signin_prompt_dismissed');
      if (dismissed === 'yes') return; // user opted out
    } catch (e) { /* ignore localStorage errors */ }

    // Delay the modal show to avoid interrupting early navigation
    var showDelay = 7000; // ms
    var modalEl = document.getElementById('signinPromptModal');
    if (!modalEl) return;
    var bsModal = new bootstrap.Modal(modalEl, { backdrop: 'static', keyboard: false });

    var timer = setTimeout(function(){
      bsModal.show();
    }, showDelay);

    // If user clicks 'Don't show again', persist choice and hide
    var dontBtn = document.getElementById('dontShowBtn');
    if (dontBtn) {
      dontBtn.addEventListener('click', function(){
        try { localStorage.setItem('signin_prompt_dismissed', 'yes'); } catch(e){}
        bsModal.hide();
      });
    }

    // If modal is dismissed via Close, set a shorter suppression to avoid immediate re-prompt on navigation
    modalEl.addEventListener('hidden.bs.modal', function(){
      try { localStorage.setItem('signin_prompt_dismissed', 'temp'); } catch(e){}
      // expire the temporary flag after 6 hours
      try {
        setTimeout(function(){ if (localStorage.getItem('signin_prompt_dismissed') === 'temp') localStorage.removeItem('signin_prompt_dismissed'); }, 6 * 60 * 60 * 1000);
      } catch(e){}
    });
  })();
</script>
</body>
</html>

